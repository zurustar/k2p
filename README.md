# Kindle to PDF (Go Implementation)

Kindle for PC/Mac などの電子書籍リーダーのスクリーンショットを自動撮影し、PDFに変換するツールです。[original kindle-to-pdf](https://github.com/rriifftt/kindle-to-pdf) の Go 言語による再実装版で、macOS での動作に最適化されています。

## 特徴
- **自動スクリーンショット**: ページを自動でめくりながらスクリーンショットを撮影します。
- **PDF変換**: 撮影した画像を自動的にPDFに変換します。
- **ファイル分割**: 指定したファイルサイズ（例: 180MB）を超えると自動でPDFを分割します。
- **macOS対応**: macOS の標準機能（AppleScript）を使用してキー操作を行うため、安定して動作します。

## 前提条件
- **macOS**: このツールは macOS 専用です。
- **権限**: ターミナルアプリ（iTerm2, Terminalなど）に以下の権限が必要です。
    - **画面収録 (Screen Recording)**: スクリーンショットを撮るために必要です。
    - **アクセシビリティ (Accessibility)**: キーボード操作（ページめくり）をシミュレートするために必要です。

## インストール

ソースコードからビルドする場合：

```bash
go build -o k2p ./cmd/k2p
```

## 使い方

1. Kindle for Mac (またはその他のリーダーアプリ) を開き、書籍を表示します。
2. リーダーアプリを**フルスクリーン**または最大化表示にします。
3. マウスカーソルを画面の端に退避させます（写り込み防止のため）。
4. ターミナルで以下のコマンドを実行します。

```bash
./k2p --output my_book.pdf
```

5. 「Press Enter to start...」と表示されたら Enter キーを押します。
6. **5秒以内**にリーダーアプリのウィンドウをクリックしてアクティブにします。
7. 自動で撮影が始まります。
8. 終了したい場合は、ターミナルに戻って **`Ctrl+C`** を押してください。撮影が停止し、PDFが生成されます。

### オプション

- `--output <filename>`: 出力するPDFのファイル名を指定します（デフォルト: `output.pdf`）。
- `--pages <N>`: 指定したページ数だけ撮影して自動終了します（指定しない場合は `Ctrl+C` を押すまで無限に続きます）。
- `--direction <ltr|rtl>`: ページめくりの方向を指定します。
    - `ltr`: 左から右へ（横書き、大多数の洋書など）。デフォルト。
    - `rtl`: 右から左へ（縦書き、日本の漫画や小説など）。**漫画などを保存する場合はこれを指定してください。**
- `--max-size <Size>`: PDFファイルの最大サイズを指定します（デフォルト: `180MB`）。このサイズを超えると `_part_1.pdf`, `_part_2.pdf` のように分割されます。
- `--temp-dir <path>`: スクリーンショットの一時保存先を指定します。

### 実行例

縦書きの漫画を100ページ分、最大50MBごとに分割して保存する場合：

```bash
./k2p --output manga.pdf --direction rtl --pages 100 --max-size 50MB
```